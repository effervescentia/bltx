{{#unless routesOnly}}
import { describe, expect, test } from 'bun:test';
import { MockRequest } from '@bltx/test';
import { setupIntegrationTest } from '@test/setup.util';
import { {{controllerName}} } from './{{controllerImport}}';

describe('{{controllerName}}', () => {
{{/unless}}
  {{#each routes}}

  describe('{{constantCase method}} {{path}}', () => {
    const { app, db } = setupIntegrationTest({{../controllerName}});

    const request = ({{#if withRequest}}body: unknown{{/if}}){{#if withResponse}}: Promise<unknown>{{/if}} =>
      app()
        .handle(
          new MockRequest('{{path}}', {
            method: '{{method}}',
            {{#if withRequest}}
            json: body,
            {{/if}}
          }),
        ){{#if withResponse}}
        .then((res) => res.json()){{/if}};

    test('example', async () => {
      {{#if withResponse}}
      const result = await request({{#if withRequest}}null{{/if}});

      expect(result).toEqual({
        // TODO: implement me
      });
      {{else}}
      await request({{#if withRequest}}null{{/if}});

      // TODO: implement me
      {{/if}}
    });
  });
  {{/each}}
{{#unless routesOnly}}
});
{{/unless}}
